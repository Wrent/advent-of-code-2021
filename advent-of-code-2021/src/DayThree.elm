module DayThree exposing (day3part1)

import Binary
import List.Extra


day3part1 : Maybe Int
day3part1 =
    let
        binaryInput : List String
        binaryInput =
            String.split "\n" day3Input

        charGroups : List (List Char)
        charGroups =
            List.range 0 11 |> List.map (getCharGroup binaryInput)
    in
    Just <| getGammaRate charGroups * getEpsilonRate charGroups


getGammaRate : List (List Char) -> Int
getGammaRate input =
    getRate input getGammaChar


getEpsilonRate : List (List Char) -> Int
getEpsilonRate input =
    getRate input getEpsilonChar


getRate : List (List Char) -> (List Char -> Bool) -> Int
getRate input fn =
    List.map fn input
        |> Binary.fromBooleans
        |> Binary.toDecimal


getGammaChar : List Char -> Bool
getGammaChar input =
    getCorrectChar input (\a b -> a > b)


getEpsilonChar : List Char -> Bool
getEpsilonChar input =
    getCorrectChar input (\a b -> a < b)


getCorrectChar : List Char -> (Int -> Int -> Bool) -> Bool
getCorrectChar input op =
    let
        ones =
            getNumberOfChars input '1'

        zeros =
            getNumberOfChars input '0'
    in
    op ones zeros


getNumberOfChars : List Char -> Char -> Int
getNumberOfChars input char =
    List.filter (\x -> x == char) input |> List.length


getCharGroup : List String -> Int -> List Char
getCharGroup list index =
    List.map String.toList list
        |> List.map (List.Extra.getAt index)
        |> List.map parseChar


parseChar : Maybe Char -> Char
parseChar maybe =
    case maybe of
        Just val ->
            val

        Nothing ->
            '_'


day3Input : String
day3Input =
    "101011111001\n111111011110\n010000111100\n101000010000\n011101100010\n010111000101\n011111011011\n011010011111\n000111000010\n000010011001\n000000100101\n000110000010\n011001010110\n011010000101\n010001000100\n111101010101\n000111110011\n010111010000\n010010000011\n101011110011\n010010010010\n010110100101\n101011010001\n101011101100\n100111011001\n100111101001\n111000111010\n100111010101\n101011100011\n110011001010\n111100011011\n111101110001\n101100000011\n000011000100\n001001000110\n001011001010\n010111101001\n100011000111\n111100010101\n101100000010\n001011111011\n101100111001\n101110110010\n011111001010\n001111001001\n110111101100\n011111001110\n111000111110\n011100101110\n000001101011\n110101001011\n111000111001\n010110011000\n000101100101\n101010110011\n111100001000\n100101000010\n110000111111\n011110001011\n000110100110\n110010001010\n001110110011\n000010000001\n100010011111\n001100001011\n110001111001\n100010011101\n010100000111\n110101000100\n011110010111\n100011010111\n001011011111\n110110010000\n101110110000\n101001001011\n011110100000\n100000000101\n100101011100\n111101101101\n101100110110\n000000011100\n101111000111\n110001000101\n000110000110\n001010001101\n101101111111\n011000011010\n101111010000\n001000101101\n010100001111\n101110011010\n011110010000\n001011011010\n100100010000\n111100011111\n111101000110\n010101101110\n010001010010\n100100000100\n101010111010\n001010001011\n000011101110\n011100110001\n000001111111\n100101000001\n101110000100\n111111100101\n111010111100\n111100000011\n000111001110\n010111001000\n010010110000\n100101000110\n100111001111\n101001110011\n001110011000\n111000001000\n010110011001\n000011001011\n000100001101\n100101110010\n110111110011\n011100000100\n111011000010\n110011010010\n011011101110\n010010111011\n110100001000\n100100111000\n111001011011\n110111000111\n011010111110\n010110011110\n111111011111\n101100110000\n011000011100\n001111111010\n011110111111\n101110110110\n100100000011\n001001100001\n010010001001\n101001100100\n110100011001\n000010101100\n001010110001\n001110011110\n111000110011\n110100001010\n110110011110\n111010100110\n100110000000\n001111010000\n110001011010\n000000101111\n100110110101\n011011100101\n001011100100\n100010111111\n010011010011\n010011100001\n011001100110\n000111101010\n111101100010\n111011101111\n111001111001\n001000001111\n010100001001\n000000011010\n111011101110\n100001000111\n010010010101\n011001100000\n100101110011\n010001011011\n110011010000\n111011001110\n001111010111\n110010110100\n101111110000\n000111011111\n111111011001\n010011001011\n101000110011\n001110101100\n001110000110\n001001110100\n000101011001\n101001111001\n001111111001\n100111111100\n010100001010\n011101111100\n011100011011\n111100110111\n000110011000\n100001111001\n000111111111\n111010010100\n110011111011\n010000001000\n000010110101\n000011111010\n010011001110\n011111000001\n110011001110\n100111110010\n011111011110\n011110110111\n001011010010\n110101010001\n100000100010\n000110100111\n101100101010\n001110111101\n010000101101\n001101011100\n101101010111\n101101010000\n111000100010\n011100110000\n001111110111\n001011000101\n111100111000\n001000001110\n101010110101\n010100110110\n101110111000\n110010000111\n111100111010\n100010111010\n010001011111\n010101011101\n010011110011\n000110110111\n000001111011\n110100010001\n001000010100\n101010011001\n010011100110\n110110011011\n110111000100\n101001110100\n010001111110\n011100001100\n011011010101\n110010010000\n101001011101\n101010010000\n111011110100\n011101110001\n111000011110\n100000100011\n010110101001\n110111111101\n010101011011\n000001110100\n000000000010\n111100101011\n111100001100\n110111000011\n011000011001\n110000011011\n100010001011\n110010011100\n001010001000\n011010000000\n110111100001\n000011001101\n001010001001\n000011101001\n011010010111\n111011011100\n110001111011\n001000111011\n110001111111\n111110011111\n011000111101\n001111101110\n111111001011\n010101110010\n000011100000\n100101101110\n001100000100\n101111001110\n001000110101\n111001011111\n011111110101\n010101011010\n111000101100\n011100000010\n011101011110\n011001101011\n000100100100\n100100010010\n010011000100\n111111100001\n010000100000\n111010001101\n000010010110\n100011101000\n100110011010\n000110100101\n011111100101\n111001101010\n101110001011\n101110101010\n011000010110\n101110011110\n101011001000\n001101000100\n111100111001\n011011101001\n100000010100\n100110101010\n010110001100\n010100100010\n001001011101\n110101101011\n111110011001\n011001011010\n000101000100\n100010111011\n000111110010\n011010001000\n001110010000\n100011001001\n010010010000\n110000010001\n000000110110\n011010000001\n010100010101\n000101011110\n101100010111\n010001111000\n100010001100\n100100100001\n011011000010\n111001001101\n111001010101\n111011011011\n001101100010\n010001000010\n111111011101\n011101101001\n010011100011\n000001000000\n100100010110\n010011000010\n010110010001\n111001001001\n010110001110\n000101110111\n001011101001\n001011111000\n111110111100\n000110111110\n001100111100\n001011000001\n110000100111\n000111001111\n101101111001\n111110100111\n111111111111\n111011010111\n001101001011\n011001011001\n010110111101\n111111000001\n001001100100\n111111101011\n011111100011\n010010110101\n011010111011\n010001010111\n001011000011\n100100001100\n110011011010\n000111111011\n011101010011\n010100010000\n110100010011\n101001110110\n111101110010\n000100001001\n111001101110\n111010110010\n010011000001\n110111011111\n111101111000\n100011010110\n001001010001\n010101100010\n110101110100\n000111101110\n111011110110\n010011011001\n100000011000\n111001110100\n011110010100\n110011011100\n011011010100\n101010101000\n000000111111\n001111110000\n110000011100\n100010100000\n101110000000\n011010011110\n110101010110\n011011100110\n111000101000\n100011101010\n000001100001\n101010011111\n111100001010\n111101001110\n011010111010\n001000011000\n101011010010\n101110001010\n101110011000\n000110000111\n110001101111\n100111000010\n011000011101\n100011000001\n010001100100\n111001100011\n111111100000\n111100101110\n001101111101\n110111101111\n100001011110\n111110100001\n011110100001\n110001001001\n001111010010\n011100100001\n010101100011\n011111011111\n010100101111\n100010001010\n010101111000\n000000001101\n000011011010\n100000010011\n001111010011\n101110110101\n000100000000\n001100101100\n100111110100\n001011100111\n110110100000\n111000000000\n110011001101\n010100011011\n100011010100\n000101011101\n110111110001\n010010100011\n011101000000\n100001001111\n101010110100\n110001101110\n100011111001\n011111011001\n000101000010\n001110100110\n100011011111\n100000000011\n110100000101\n001110110100\n101101001110\n000011010100\n110000001100\n110010110101\n110110101010\n001010001110\n111000010100\n011111100110\n000100011110\n010000010011\n010010100001\n000111010111\n110001001101\n010010110110\n010111010011\n101101011000\n100001110111\n101110001110\n010001110000\n101001111111\n100000001100\n000010000011\n011110010011\n110001000100\n001101110111\n110000110110\n100010000100\n100011111110\n001010000101\n111011010101\n111100000010\n110110010111\n000100111011\n011110111000\n001100001000\n101010100101\n110000111100\n010110100111\n111111111011\n110111011100\n111101110000\n111010000100\n001000110000\n101010101100\n100011100011\n110011110010\n001010111110\n100001010001\n010010111000\n000011001110\n001100010000\n011100110111\n001011101100\n011000111110\n011101001111\n011010000111\n111000010000\n001111001111\n011001100111\n011000110101\n111100110010\n000101000111\n101100110001\n110010110000\n000011011111\n110010011001\n010011000101\n010000111110\n000100101000\n101101100000\n110011101110\n011100100100\n111011100100\n100101010111\n001000010111\n011011110001\n011100010000\n001011110010\n111111100011\n001011111100\n110011101100\n100111000111\n010011011111\n100100110001\n101111101001\n101001110010\n000010110111\n111011111111\n100011111010\n101010111001\n101111100001\n000000011001\n011111000011\n000100001110\n001011110100\n000110111111\n001101110101\n000000010001\n010111001100\n001010100110\n110110000101\n110001000010\n100010000011\n001011001000\n101111011110\n111011111100\n011000011000\n101010101010\n111010110011\n110101000101\n010101000110\n000000010011\n101000001010\n100010101110\n110110000001\n011100010101\n101000110111\n010101000001\n000011011100\n110010100010\n011110110011\n010111111000\n110100101101\n111011111101\n011111111101\n100101001011\n010111000001\n000011011001\n000011100010\n100101111101\n000000101001\n111111000111\n111011000110\n101000001100\n000110000001\n001111011100\n000100010000\n100111101011\n111011011010\n011110010110\n001010010101\n100100110110\n000101111001\n000100011010\n011010010010\n001101001000\n001011011110\n000011101011\n001100011001\n110101100011\n100010000101\n011011100001\n011011110000\n100101100011\n010110111000\n001001001011\n000010111110\n000011010101\n110110011111\n001111000101\n110101111011\n011010010100\n000100110011\n110011110110\n010011101011\n100100001101\n110010000101\n010111100111\n100111111000\n011001001011\n011010100011\n110101111000\n011000111010\n011101000100\n001100110000\n010101111011\n101010010010\n010001000110\n000101111111\n110111001000\n110101111010\n100110010100\n110001000001\n011110001001\n010111110011\n010001010110\n011100111001\n110000010110\n010000010110\n010111111011\n000101101110\n100000001111\n010111111010\n000010001111\n100101110100\n000111100010\n000000101101\n010001011010\n010110111010\n011110111010\n110100000100\n101110000011\n110110100100\n110111110111\n110101011100\n100010010101\n001010110100\n110101001101\n000100110010\n111111111010\n001001000001\n000011110001\n010110111011\n001111101011\n010100100101\n001110010111\n100010010111\n100011110101\n001100001100\n010000000100\n011010110011\n100011101110\n010000000001\n100010010011\n110100111001\n000000110001\n000001000101\n011011001011\n000100101001\n010100001110\n000110001111\n011110000110\n110000000110\n010101001000\n000110111010\n011111100010\n111111010101\n101011000001\n001010101101\n110101111111\n001110110101\n010100101001\n110101100111\n010000101000\n011011110110\n111111110110\n010000100111\n000011010001\n101000011010\n001110000000\n111010110110\n011110011110\n100101001101\n101000000010\n001111101111\n011100001011\n011000011111\n001001001010\n100010011010\n100010100011\n000110010011\n100001110100\n010000011110\n011111000100\n001010101111\n111111001100\n010101110011\n110100110000\n010110010101\n111011000111\n001000111001\n010110110101\n110001011111\n010010101100\n110000101101\n100010000001\n111111110011\n110000010010\n111110000001\n100101011000\n010101010111\n100111101100\n100110101100\n110111000110\n000011111110\n100101100010\n000010010001\n111100100011\n001001111100\n100011110110\n111111011100\n110001100011\n110010111110\n000100010001\n000101100110\n100100000110\n010001101001\n011010010110\n100010110000\n001000001000\n101101011100\n111100111110\n001001011011\n010111101000\n100001100010\n000101111101\n101111110101\n001110000111\n010011010010\n100100110101\n101011011111\n111100010010\n110111010000\n111001101011\n100001001101\n101100000101\n011100101000\n000000100011\n000000111110\n001010001100\n100001110101\n100111011100\n110111100000\n101010101011\n001011000000\n011011111110\n001000101111\n101111101100\n001010011001\n100110101001\n101110010001\n110000011101\n001110000001\n000001100110\n011001101100\n000100000101\n110111010001\n101101100100\n010110101000\n001100001001\n000111001001\n010010101000\n101000001101\n110010000001\n110110010101\n110110001111\n101100110010\n000101110101\n011011101011\n000100100111\n110000111011\n101011011010\n000010101001\n110101101010\n111100101111\n101001010111\n110101100010\n001100100010\n101110111110\n110011110101\n000101111010\n011000111001\n110101001000\n101000100010\n111111001000\n111001101100\n110010100111\n011010110100\n100101111010\n000110010101\n101110000001\n001011110011\n011111110001\n101000101001\n011011001111\n100010001110\n111111110111\n010101111100\n100001000001\n010011110100\n001000010110\n001011101111\n010100011000\n011110111101\n111100110100\n100111011011\n000011001000\n001110100000\n010100011001\n101110001101\n100011001010\n111101011001\n000011100011\n110101011110\n111110001010\n010100010010\n000110110010\n001001001001\n100010110001\n110000110101\n111000101101\n011110010101\n010001000000\n000110001001\n011001111110\n010100111111\n001101110001\n011110000001\n110111111011\n011101000111\n110000111101\n010001110100\n010111011001\n110111010101\n001101000001\n011010000010\n110011010100\n111000110110\n001000000100\n111011001111\n010101010000\n001011101010\n010011010110\n111101100101\n111011011000\n001000100010\n111010000000\n101111011111\n100000111111\n110010000000\n100000011111\n110011001011\n001001111111\n010101101101\n111100011010\n100101100101\n001110001011\n001110111111\n101110011001\n100100110111\n110100000000\n111010110111\n111100110001\n111010100000\n010001100101\n011110100010\n100110010010\n001010110010\n011000100111\n010011011000\n110011010110\n010000001110\n011100111111\n011011000100\n101111001101\n111111011010\n011111010101\n111011101101\n011010000110\n011111111011\n010000011001\n001010001111\n100001010011\n101011001101\n011100111100\n110100011111\n011111011000\n110010111001\n111100100000\n101111100010\n100001101001\n110010111011\n010010001011\n001000011110\n000101010111\n011011111001\n101101000101\n000101100111\n101111111110\n000100110111\n111000011010\n010110111100\n111100001110\n111000100001\n010100000011\n010100110111\n110111010100\n011001001101\n100100101010\n111110110000\n110101110001\n110010100000\n001010011101\n111101001101\n010010000000\n111010111011\n011011110011\n111010001111\n101001111101\n100110000110\n000000000000\n010001110011\n100000111000\n101010100010\n010101100100\n110000110000\n000010011101\n011111001000\n111110011010\n010101001001\n011001111010\n101111000011\n110010111111\n110110001101\n000001010110\n101011100001\n100111100001\n010100100000\n100011101100\n010001100011\n110011000111\n000000000101\n101111110001\n010110011101\n111101000001\n101101011011\n100011101011"
